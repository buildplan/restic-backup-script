# =================================================================
#      Configuration for Restic Backup Script v0.04
# =================================================================
# !! IMPORTANT !! Set file permissions to 600 (chmod 600 restic-backup.conf)

# --- Repository Settings ---
# Format: sftp:hostname_from_.ssh_config/path/to/backup
RESTIC_REPOSITORY="sftp:storagebox:/home/vps"

# Password file for repository encryption (create with: echo 'your-password' > /root/.restic-password)
RESTIC_PASSWORD_FILE="/root/.restic-password"

# --- Source Directories ---
# Space-separated list of directories to backup
BACKUP_SOURCES="/home/user_files"

# --- Backup Options ---
# Backup tag to identify snapshots
BACKUP_TAG="daily-$(hostname)"

# Compression level: auto, off, max
COMPRESSION="max"

# Pack size for optimization (default: empty for auto)
PACK_SIZE="64"

# Enable one-file-system (don't cross filesystem boundaries)
ONE_FILE_SYSTEM=true

# --- Retention Policy ---
# How many snapshots to keep
KEEP_LAST="10"
KEEP_DAILY="7"
KEEP_WEEKLY="4" 
KEEP_MONTHLY="12"
KEEP_YEARLY="3"

# --- Performance ---
# Use nice and ionice for lower priority
LOW_PRIORITY=true

# Nice level (0-19, higher = lower priority)
NICE_LEVEL="19"

# IOnice class (1=real-time, 2=best-effort, 3=idle)
IONICE_CLASS="3"

# --- Logging ---
LOG_FILE="/var/log/restic-backup.log"
LOG_LEVEL="1" # 0=quiet, 1=normal, 2=verbose, 3=very verbose

# Max log size in MB before rotation
MAX_LOG_SIZE_MB="10"

# Days to keep rotated logs
LOG_RETENTION_DAYS="30"

# --- Notifications ---
# Enable notifications
NTFY_ENABLED=true
DISCORD_ENABLED=false

# ntfy settings
NTFY_TOKEN="xxxxxxxxxxxxxxxxxxx"
NTFY_URL="https://ntfy.mydomain.tld/topic"

# ntfy priorities (1=min, 3=default, 5=max)
NTFY_PRIORITY_SUCCESS=3
NTFY_PRIORITY_WARNING=4
NTFY_PRIORITY_FAILURE=4

# Discord webhook (if enabled)
DISCORD_WEBHOOK_URL="https://discord.com/api/webhooks/your/webhook_url_here"

# --- Maintenance ---
# Run integrity check after backup
CHECK_AFTER_BACKUP=false

# Prune repository after forget (removes unreferenced data)
PRUNE_AFTER_FORGET=true

# --- Exclusions ---
# File containing exclude patterns (one per line)
EXCLUDE_FILE="/etc/restic-excludes.txt"

# Additional exclude patterns (space-separated)
EXCLUDE_PATTERNS="*.tmp *.log *.cache .DS_Store Thumbs.db"
